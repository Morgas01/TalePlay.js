(function(t,e,s){var i=s("Layer.ActionMenu"),n=s("shortcut")({manager:"GUI.ControllerManager",debug:"debug"}),o=i.GameMenu=t.Class(i,{init:function(t){t=t||{};var e={styleClass:["panel"],actions:[{text:"Controllers",action:"openControllerManager",controllerLayout:t.controllerLayout||{}},{text:"save",action:"saveGame",data:t.saveData},{text:"close",action:"close"}]};t.saveData||(e.disabled=[0]),this.superInit(i,e),this.domElement.classList.add("GameMenu"),this.createListener("start close"),this.persistanceLayer="function"==typeof t.persistanceLayer?t.persistanceLayer:s(t.persistanceLayer||"Layer.Persistance"),this.dbConn=t.dbConn,this.saveClass=t.saveClass,this.saveConverter=t.saveConverter},onController:function(t){if("buttonChanged"===t.type&&1==t.value)switch(t.index){case 1:this.menu.setActive(2);break;case 2:i.prototype.onController.call(this,t)}else i.prototype.onController.call(this,t)},openControllerManager:function(t){var e={styleClass:["panel","overlay"],buttons:t.controllerLayout.buttons,analogSticks:t.controllerLayout.analogSticks,dbConn:this.dbConn},s=new n.manager(e);this.add(s),s.update("controllers")},saveGame:function(t){if(t.data){var e=new this.persistanceLayer({dbConn:this.dbConn,saveClass:this.saveClass,saveConverter:this.saveConverter,saveData:t.data});this.board.addLayer(e)}},close:function(){this.fire("close")}});e("RPGPlayer.GameMenu",o)})(Morgas,Morgas.setModule,Morgas.getModule);