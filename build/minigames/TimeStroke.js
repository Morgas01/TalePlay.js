(function(t,e,i){var s=i("GUIElement"),n=i("shortcut")({rescope:"rescope"}),o=t.Class(s,{init:function(t){t=t||{},this.superInit(s,t.styleClass),this.addStyleClass("TimeStroke"),n.rescope.all(["_step"],this),this.createListener("hit miss finish"),this.buttonItems=t.buttonItems||[],this.speed=t.speed||30,this.zoneWidth=t.zoneWidth||10,this.request=null,this.lastStep=null,this.time=0,this.domElement.innerHTML='<div class="zone" style="width:'+this.zoneWidth+'%;"></div>'},start:function(t){void 0!==t&&(this.time=t),null===this.request&&this.buttonItems.length>0&&this._step(Date.now()-performance.timing.navigationStart)},pause:function(){cancelAnimationFrame(this.request),this.request=this.lastStep=null},stop:function(){this.pause();for(var t=0;this.buttonItems.length>t;t++)this.buttonItems[t].domElement.remove();this.buttonItems.length=0},onButton:function(t){var e=this.buttonItems[0];1===t.value&&(e&&e.active===!0&&e.button===t.index?(this.fire("hit",{buttonItem:e}),this.buttonItems.splice(0,1),e.domElement.remove(),0===this.buttonItems.length&&(this.stop(),this.fire("finish"))):this.fire("miss",{buttonItem:null}))},_step:function(t){this.request=requestAnimationFrame(this._step),t&&this.lastStep&&(this.time+=t-this.lastStep);for(var e=this.time+1e3*(100/this.speed),i=0;this.buttonItems.length>i&&e>this.buttonItems[i].time;i++){var s=this.buttonItems[i],n=(s.time-this.time)*this.speed/1e3;n>0?(s.domElement.style.left=n+"%",s.domElement.dataset.active=s.active=this.zoneWidth>=n,-1===Array.prototype.indexOf.call(this.domElement.children,s.domElement)&&this.domElement.appendChild(s.domElement)):(this.fire("miss",{buttonItem:s}),s.domElement.remove(),this.buttonItems.splice(i,1),i--,0===this.buttonItems.length&&(this.stop(),this.fire("finish")))}this.lastStep=t}});o.ButtonItem=function(t,e){this.button=t,this.time=e,this.domElement=document.createElement("span"),this.domElement.classList.add("ButtonItem"),this.domElement.text=t,this.active=!1},e("Minigames.TimeStroke",o)})(Morgas,Morgas.setModule,Morgas.getModule);